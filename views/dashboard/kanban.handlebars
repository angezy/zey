</head>

<body class="g-sidenav-show   bg-gray-100">
  <div class="min-height-300 bg-primary position-absolute w-100"></div>
  {{> __dsidenav}}
  <main class="main-content position-relative border-radius-lg ">
    {{> __dashnavbar}}

    <div class="row">
      <div class="col-md-12 mt-4">
        <div class="card">
          <div class="card-header pb-0 p-3">
            <h6 class="mb-0">Kanban Feature</h6>
          </div>
          <div class="card-body pt-4 p-3">
            <form id="kanbanForm" method="POST" action="/api/kanban">
              <!-- Facebook Name -->
              <div class="mb-3">
                <label for="facebookName" class="form-label">Facebook Name</label>
                <input type="text" class="form-control" id="facebookName" name="facebookName" required
                  placeholder="Enter Facebook Name">
              </div>

              <!-- Role Selection -->
              <div class="mb-3">
                <label class="form-label">Role</label>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="role" id="wholesaler" value="Wholesaler" required>
                  <label class="form-check-label" for="wholesaler">Wholesaler</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="role" id="cashBuyer" value="CashBuyer">
                  <label class="form-check-label" for="cashBuyer">Cash Buyer</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="role" id="homeSeller" value="HomeSeller">
                  <label class="form-check-label" for="homeSeller">Home Seller</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="role" id="otherRole" value="Other">
                  <label class="form-check-label" for="otherRole">Other</label>
                </div>
              </div>

              <!-- Specify Role (Visible only when "Other" is selected) -->
              <div class="mb-3" id="otherRoleInputContainer" style="display: none;">
                <label for="specificRole" class="form-label">Specify Role</label>
                <input type="text" class="form-control" id="specificRole" name="specificRole"
                  placeholder="Enter their role">
              </div>

              <!-- Chat Result -->
              <div class="mb-3">
                <label for="chatResult" class="form-label">Chat Result</label>
                <textarea class="form-control" id="chatResult" name="chatResult" required></textarea>
              </div>

              <!-- Email -->
              <div class="mb-3">
                <label for="email" class="form-label">Email (Optional)</label>
                <input type="email" class="form-control" id="email" name="email">
              </div>

              <!-- Phone Number -->
              <div class="mb-3">
                <label for="phoneNumber" class="form-label">Phone Number (Optional)</label>
                <input type="text" class="form-control" id="phoneNumber" name="phoneNumber">
              </div>


              <!-- Submit Button -->
              <button type="submit" class="btn btn-primary">Add Entry</button>
            </form>


            <hr>
            <h6 class="mb-3">Existing Entries</h6>
            <table class="table align-items-center mb-0">
              <thead>
                <tr>
                  <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">
                    FaceBook Name</th>
                  <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">
                    Chat Result</th>
                  <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">
                    Role</th>
                  <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">
                    Chat Date
                  </th>
                  <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">
                     Contact</th>
                  <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">
                    Status
                  </th>
                </tr>
              </thead>
              <tbody>
                {{#each kanban}}
                <tr>
                  <td>
                    <div class="d-flex px-2 py-1">
                      <div>
                        <img src="../assets/img/team-2.jpg" class="avatar avatar-sm me-3" alt="user1">
                      </div>
                      <div class="d-flex flex-column justify-content-center">
                        <h6 class="mb-0 text-sm">{{this.FacebookName}}</h6>
                        <p class="text-xs text-secondary mb-0"><a href="mailto:{{this.Email}}"
                            class="text-secondary font-weight-bold text-xs">{{this.Email}}</a></p>
                      </div>
                    </div>
                  </td>
                  <td class="align-middle text-center">
                    <span class="text-secondary text-xs font-weight-bold">{{this.ChatResult}}</span>
                  </td>
                  <td class="align-middle text-center">
                    {{#if (eq this.Role "other")}}
                    <span class="badge badge-sm bg-gradient-info">{{this.SpecificRole}}</span>
                    {{else}}
                    <span class="badge badge-sm bg-gradient-success">{{this.Role}}</span>
                    {{/if}}
                  </td>
                  <td class="align-middle text-center">
                    <span class="text-secondary text-xs font-weight-bold">{{formatDate this.ChatDate}}</span>
                  </td>
                  <td class="align-middle text-center">
                    <a href="tel:{{this.PhoneNumber}}" title="{{this.PhoneNumber}}" class="text-secondary font-weight-bold text-xs"
                      data-toggle="tooltip" data-original-title="Call">
                      Call
                    </a>
                  </td>
                </tr>
                {{/each}}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <script>
      document.addEventListener('DOMContentLoaded', () => {
        const otherRoleRadio = document.getElementById('otherRole');
        const otherRoleInputContainer = document.getElementById('otherRoleInputContainer');
        const roleRadios = document.querySelectorAll('input[name="role"]');

        roleRadios.forEach(radio => {
          radio.addEventListener('change', () => {
            if (otherRoleRadio.checked) {
              otherRoleInputContainer.style.display = 'block';
            } else {
              otherRoleInputContainer.style.display = 'none';
            }
          });
        });
      });
    </script>


    <script>
      const urlParams = new URLSearchParams(window.location.search);
      const successMessage = urlParams.get('success');
      const errorMessage = urlParams.get('error');

      if (successMessage) {
        Swal.fire({ title: 'Success', text: successMessage, icon: 'success' }); // Show success message
      }

      if (errorMessage) {
        Swal.fire({ title: 'Error', text: errorMessage, icon: 'error' }); // Show error message
      }

    </script>